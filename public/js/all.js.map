{"version":3,"sources":["jquery.clearable.js","Currency.js","Numeric.js","invoice_detail.js","invoice_list.js","app.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACtBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC7SA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC/BA;AACA;AACA;AACA;AACA;AACA;AACA","file":"all.js","sourcesContent":["/**\n * jquery.clearable.js\n *\n * Adapted from http://stackoverflow.com/questions/6258521/clear-icon-inside-input-text\n * Requires the following CSS:\n .clearable {\n        background: #fff url(data:image/gif;base64,R0lGODlhBwAHAIAAAP///5KSkiH5BAAAAAAALAAAAAAHAAcAAAIMTICmsGrIXnLxuDMLADs=) no-repeat right -10px center;\n        border: 1px solid #999;\n        padding: 3px 24px 3px 4px; // Second value must match settings.offset\n        border-radius: 3px;\n    }\n .clearable.x  { background-position: right 10px center; }\n .clearable.onX{ cursor: pointer; }\n .clearable::-ms-clear {display: none; width:0; height:0;}\n\n */\n\n(function ($) {\n    $.fn.clearable = function (options) {\n        var settings = $.extend({\n            animate: false,\n            offset: 24, // Pixels of offset from right end of input\n            // Optional callbacks\n            onInput: function() {},\n            onClear: function() {}\n        }, options);\n\n        // Add class to target if not present\n        this.addClass('clearable');\n        // Events\n        this.on('input', function (evt) {\n            if (settings.animate) {\n                $(this).css({ transition: 'background 0.4s' })\n            }\n            $(this)[_toggle(this.value)]('x');\n            settings.onInput($(this));\n        }).on('mousemove', function(evt){\n            $(this)[_toggle(_isOnX(evt))]('onX');\n        }).on('touchstart click', function(evt){\n            evt.preventDefault();\n            if (_isOnX(evt)) {\n                settings.onClear($(this));\n                $(this).removeClass('x onX').val('').change();\n            }\n        });\n\n        // Determine whether user's mouse is over the 'X'\n        function _isOnX(evt) {\n            return (evt.target.offsetWidth - settings.offset) < (evt.clientX - evt.target.getBoundingClientRect().left);\n        }\n\n        // Add or remove classes based on value\n        function _toggle(value) {\n            return value ? 'addClass' : 'removeClass';\n        }\n\n        return this;\n    };\n\n\n}(jQuery));","var Currency = {\n    locale: 'us',\n    currency: 'usd',\n    minDigits: 2,\n    maxDigits: 2,\n    options: {},\n    formatter: null,\n    toDollar: function (amount) {\n        this._setOptions({}); // Use defaults\n        return this.formatter.format(amount)\n    },\n    toEuro: function (amount) {\n        this._setOptions({\n            locale: 'de',\n            currency: 'eur'\n        }); // Use defaults\n        return this.formatter.format(amount)\n    },\n    _setOptions: function (options) {\n        $.extend(this, options);\n        this.options = {\n            style: 'numeric',\n            currency: this.currency,\n            minimumFractionDigits: this.minDigits,\n            maximumFractionDigits: this.maxDigits\n        };\n        this.formatter = new Intl.NumberFormat(this.locale, this.options);\n    }\n}\n\n","/**\n * Numeric.js\n *\n * Simple number-based utility class\n */\n\nvar Numeric = {\n    toDollar: function(amount) {\n        return '$' + this.numberFormat(amount, 2, '.', ',') ;\n    },\n    numberFormat: function (number, decimals, dec_point, thousands_sep) {\n        number = isNaN(number * 1) ? 0 : number * 1;\n        var str = number.toFixed(decimals ? decimals : 0).toString().split('.');\n        var parts = [];\n        for (var i = str[0].length; i > 0; i -= 3) {\n            parts.unshift(str[0].substring(Math.max(0, i - 3), i));\n        }\n        str[0] = parts.join(thousands_sep ? thousands_sep : ',');\n\n        return str.join(dec_point ? dec_point : '.');\n    }\n}\n","/* Support for Invoice Detail page */\n\n\nvar InvoiceLineitem = {\n    invoiceId: 0,\n    lineitemModal: null,\n    selectedLineitemId: 0,\n    numeric: null,\n    init: function (options) {\n        $.extend(this, options);\n\n        this.numeric = Object.create(Numeric);\n        this._setEvents();\n    },\n    _initLineitemModal: function () {\n        var self = this;\n        this.lineitemModal = $('#lineitem_modal');\n        this.lineitemModal.modal();\n    },\n    _calculateAmount: function () {\n        var billing_rate = $('#billing_rate_id option:selected').text();\n        var hours = $('#hours').val();\n        var amount = 0;\n        if (billing_rate && hours) {\n            amount = (parseFloat(billing_rate) * parseFloat(hours));\n        }\n        $('#amount').val(amount.toFixed(2));\n        $('#amount_display').html(this.numeric.toDollar(amount.toFixed(2)));\n    },\n    _clearForm: function () {\n        $('#update_lineitem').each(function () {\n            $(this).find('input, select, textarea').val('');\n        });\n        this._calculateAmount();\n    },\n    _hydrateLineitem: function (data) {\n        for (var key in data) {\n            if (data.hasOwnProperty(key)) {\n                var value = (data[key] != null) ? data[key] : '';\n                var $field = $('#' + key);\n                if ($field.length > 0) {\n                    $field.val(value);\n                }\n            }\n        }\n    },\n    _retrieveLineitem: function (lineitemId) {\n        var self = this;\n        this.selectedLineitemId = lineitemId;\n        if (lineitemId != 0) {\n            $.ajax({\n                type: \"GET\",\n                url: appSpace.baseUrl + '/invoice/get_lineitem/' + appSpace.invoiceId + '/' + lineitemId,\n                dataType: 'json',\n                success: function (response) {\n                    self._hydrateLineitem(response.data);\n                    self._calculateAmount();\n                    self._initLineitemModal();\n                },\n                error: function (response) {\n                    var foo = 'bar';\n                }\n            });\n        } else {\n            this._clearForm();\n            this._setupNewLineitem();\n            this._initLineitemModal();\n        }\n    },\n    _saveLineitem: function() {\n        $.ajax({\n            type: \"GET\",\n            url: appSpace.baseUrl + '/invoice/update_lineitem',\n            data: $('form[name=update_lineitem]').serialize(),\n            dataType: 'json',\n            success: function (response) {\n                var foo = 'bar';\n                //self._hydrateLineitem(response.data);\n                //self._calculateAmount();\n                //self._initLineitemModal();\n            },\n            error: function (response) {\n                var foo = 'bar';\n            }\n        });\n    },\n    _setEvents: function () {\n        var self = this;\n        $('#lineitem_add').on('click', function () {\n            self._retrieveLineitem(0);\n        });\n\n        $('#lineitem_save').on('click', function () {\n            if (self.selectedLineitemId != null) {\n                self._saveLineitem();\n            }\n        });\n\n        $('tr.lineitem').on('click', function () {\n            var itemId = $(this).attr('data-id');\n            self._retrieveLineitem(itemId);\n        });\n\n        $('#billing_rate_id, #hours').on('change keyup', function () {\n            self._calculateAmount();\n        });\n\n    },\n    _setupNewLineitem: function() {\n        $('#id').val('0');\n        $('#invoice_id').val(this.invoiceId);\n    }\n};\n\nvar InvoiceDetail = {\n    itemManager: null,\n    clientSelectList: null,\n    clientModal: null,\n    invoiceId: 0,\n    dateItem: null,\n    detailsUrl: '',\n    updateUrl: '',\n    selectedClientId: 0,\n    init: function (options) {\n        $.extend(this, options);\n        // Instantiate the lineitem manager\n        this.itemManager = Object.create(InvoiceLineitem);\n        this.itemManager.init({ 'invoiceId': this.invoiceId });\n\n        this._initClientTable();\n        // Auto-display the client modal if this is a new invoice\n        if (this.invoiceId == 0) {\n            this._initClientModal();\n        }\n        this._setEvents();\n    },\n    _initClientTable: function () {\n        var self = this;\n        this.clientSelectList = $('#select_client_list').DataTable({\n            iDisplayLength: 10, // Default to this number per page\n            aaSorting: [],\n            fnDrawCallback: function () {\n                self._selectClientEvent();\n                // Hide pagination buttons of only one page is showing\n                var $paginates = $('.dataTables_paginate').find('.paginate_button');\n                $('.dataTables_paginate').toggle($paginates.length > 3);\n            },\n            initComplete: function () {\n                var $search = $($(this).selector + '_filter').find('input[type=\"search\"]');\n                // Add 'clearable' x to search field, and callback to restore table on clear\n                $search.addClass('clearable').clearable({\n                    onClear: function () {\n                        // Refresh table\n                        self.clientSelectList.search('').columns().search('').draw();\n                    }\n                });\n                $('#select_client_list_length').hide();\n            }\n        });\n    },\n    _initClientModal: function () {\n        var self = this;\n        this.clientModal = $('#client_selector');\n        this.clientModal.modal();\n    },\n    _hideDates: function () {\n        var self = this;\n        $('[data-datetype]').each(function () {\n            if (this != self.dateItem) {\n                $(this).find('div').show();\n                $(this).find('input').hide();\n            }\n        });\n\n    },\n    _hydrateClient: function (data) {\n        for (var key in data) {\n            if (data.hasOwnProperty(key)) {\n                var value = (data[key] != null) ? data[key] : '';\n                var $field = $('#' + key);\n                if (value.length != 0) {\n                    $field.html(value)\n                        .removeClass('hidden')\n                        .show();\n                }\n            }\n        }\n    },\n    _retrieveClient: function () {\n        var self = this;\n        if (this.selectedClientId != null) {\n            $.ajax({\n                type: \"GET\",\n                url: appSpace.baseUrl + '/invoice/set_client/' + appSpace.invoiceId + '/' + this.selectedClientId,\n                dataType: 'json',\n                success: function (response) {\n                    if (response.client_info) {\n                        self._hydrateClient(response.client_info);\n                    }\n                    // If this is a new invoice, reload\n                    if (response.invoice_id) {\n                        document.location = self.detailsUrl + response.invoice_id;\n                    }\n                },\n                error: function (response) {\n                    var foo = 'bar';\n                }\n            })\n        }\n    },\n    _saveData: function () {\n        $.ajax({\n            type: \"GET\",\n            url: this.updateUrl,\n            data: $('form[name=details_form]').serialize(),\n            dataType: 'json',\n            success: function (response) {\n                var foo = 'bar';\n            },\n            error: function (response) {\n                var foo = 'bar';\n            }\n        })\n    },\n    _setEvents: function () {\n        var self = this;\n        this._selectClientEvent();\n\n        $('#edit_client').on('click', function () {\n            self._initClientModal();\n        });\n\n        $('#select_client').on('click', function () {\n            if (self.selectedClientId != null) {\n                self._retrieveClient();\n            }\n        });\n\n        this._setupDatepickers();\n    },\n    _selectClientEvent: function () {\n        var self = this;\n        $('.client_row').on('click', function () {\n            $('.client_row').removeClass('selected');\n            self.selectedClientId = $(this).attr('data-id');\n            $(this).addClass('selected');\n            $('.btn-primary').attr('data-dismiss', 'modal');\n        });\n    },\n    _setupDatepickers: function () {\n        var self = this;\n\n        $('[data-datetype]').on('click', function () {\n            var $dateItem = $(this).find('div');\n            var $dateInput = $(this).find('input');\n            var isVisible = $dateInput.is(':visible');\n            // Hide dates except for the current one\n            self.dateItem = this;\n            self._hideDates();\n            // Toggle visibility of just this date item\n            $dateItem.toggle(isVisible);\n            $dateInput.toggle(!isVisible);\n            $dateInput.datepicker({\n                    format: 'm/d/yyyy',\n                    showClose: true,\n                })\n                .on('changeDate', function () {\n                    // Write the value from the input to the div\n                    var $dateItem = $(this).prev('div');\n                    var $dateInput = $(this);\n                    $dateItem.html($dateInput.val())\n                        .show();\n                    $dateInput.hide();\n                    $(this).datepicker('hide');\n                    appSpace.invoiceDetail._saveData();\n                })\n                .focus();\n            if (!isVisible) {\n                $dateInput.attr('readonly', 'readonly');\n            } else {\n                $dateInput.attr('readonly', 'readonly');\n            }\n        });\n        // Override the click behavior\n        $('[data-datetype] input').on('click', function (evt) {\n            evt.preventDefault();\n            return false;\n        });\n    }\n};\n\n$(document).ready(function ($) {\n    if ($('#select_client_list').is('*')) {\n        appSpace.invoiceDetail = Object.create(InvoiceDetail);\n        appSpace.invoiceDetail.init({\n            invoiceId: appSpace.invoiceId,\n            detailsUrl: appSpace.baseUrl + '/invoice/details/',\n            updateUrl: appSpace.baseUrl + '/invoice/update/'\n        });\n    }\n});\n","/* Support for Invoice list page */\n$(document).ready(function ($) {\n    if ($('.invoice-list').is('*')) {\n        $('.invoice-list tbody tr').on('click', function () {\n            var id = $(this).attr('data-id');\n            document.location = appSpace.baseUrl + '/invoice/details/' + id;\n        });\n\n        var mainInvoiceList = $('#main_invoice_list').DataTable({\n            lengthMenu: [[10, 25, 50, -1], [10, 25, 50, \"All\"]], // Number of entries to show\n            iDisplayLength: 25, // Default to this number per page\n            aaSorting: [],\n            fnDrawCallback: function() {\n                // Hide pagination buttons of only one page is showing\n                var $paginates = $('.dataTables_paginate').find('.paginate_button');\n                $('.dataTables_paginate').toggle($paginates.length > 3);\n            },\n            initComplete: function () {\n                var $search = $($(this).selector + '_filter').find('input[type=\"search\"]');\n                // Add 'clearable' x to search field, and callback to restore table on clear\n                $search.addClass('clearable').clearable({\n                    onClear: function() {\n                        // Refresh table\n                        mainInvoiceList.search( '' ).columns().search( '' ).draw();\n                    }\n                });\n\n            }\n        });\n    }\n});\n","/*\n* app.js\n*\n* Custom Javascript code used throughout the application\n*\n*/\n"]}